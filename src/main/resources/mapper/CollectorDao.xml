<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.cbb.wasteRecovery.dao.CollectorDao">
<resultMap type="org.cbb.wasteRecovery.bean.Collector" id="Collect">
  <id property="id" column="id"/>
  <result property="realName" column="realName"/>
  <result property="sex" column="sex"/>
  <result property="password" column="password"/>
  <result property="avater" column="avater"/>
  <result property="phoneNumber" column="phoneNumber"/>
  <result property="photo" column="photo"/> 
  <result property="idCardNum" column="idCardNum"/>
  <result property="idCardFrontPhoto" column="idCardFrontPhoto"/>
  <result property="idCardBackPhoto" column="idCardBackPhoto"/>
   <result property="volume" column="volume"/>
  <result property="bankAccount" column="bankAccount"/> 
  <result property="state" column="state"/> 
  <result property="createTime" column="createTime"/>
  <result property="staid" column="staid"/>

  <collection property="unDidOrderformList" resultMap="org.cbb.wasteRecovery.dao.OrderformDao.order1"/>
</resultMap>
 <resultMap type="org.cbb.wasteRecovery.bean.Collector" id="Collect1">
        <id property="id" column="id"/>
        <result property="realName" column="realName"/>
        <result property="sex" column="sex"/>
        <result property="password" column="password"/>
        <result property="avater" column="avater"/>
        <result property="phoneNumber" column="phoneNumber"/>
        <result property="photo" column="photo"/>
        <result property="idCardNum" column="idCardNum"/>
        <result property="idCardFrontPhoto" column="idCardFrontPhoto"/>
        <result property="idCardBackPhoto" column="idCardBackPhoto"/>
        <result property="volume" column="volume"/>
        <result property="bankAccount" column="bankAccount"/>
        <result property="state" column="state"/>
        <result property="createTime" column="createTime"/>
        <result property="staid" column="staid"/>
</resultMap>

    <sql id="columns">c.realName,c.sex,c.password,c.phoneNumber,c.photo,c.idCardNum,c.idCardFrontPhoto,c.idCardBackPhoto,c.createTime,c.avater,c.staid,c.state,c.volume,
    o.id,o.state,o.weight,o.createTime,o.appointTime,o.updateTime,o.price,o.aid,o.uid,o.cid</sql>

    <insert id="insertCollector">
    insert  into collector(realName,sex,password,phoneNumber,photo,idCardNum,idCardFrontPhoto,idCardBackPhoto,createTime,avater,staid,state,volume)
    values (#{realName},#{sex},#{password},#{phoneNumber},#{photo},#{idCardNum},#{idCardFrontPhoto},#{idCardBackPhoto},#{createTime},#{avater},#{staid},#{state},#{volume})
   </insert>


    <select id="selectById" resultMap="Collect" parameterType="int">
        select <include refid="columns"/>
		from
			collector c LEFT JOIN orderform o 
			ON c.id=o.cid
		where c.id=#{id}
    </select>

    <select id="selectByPhoneNum" resultMap="Collect" parameterType="String">
        select <include refid="columns" /> 
		from 
			collector c LEFT JOIN orderform o 
			ON c.id=o.cid
		where c.phoneNumber=#{phoneNumber}
    </select>
    
     <select id="selectByPhoneNumAndPass" resultMap="Collect" >
        select <include refid="columns"/>
		from 
			collector c LEFT JOIN orderform o 
			ON c.id=o.cid
        where 
			c.phoneNumber=#{phoneNumber} 
			and c.password=#{password}
    </select>

    <select id="selectByIdCardNum"  resultMap="Collect" parameterType="String">
        select <include refid="columns"/> 
		from 
			collector c LEFT JOIN orderform o 
			ON c.id=o.cid 
		where 
			c.idCardNum=#{idCardNum}
    </select>
    
    <select id="selectByName" resultMap="Collect">
        select <include refid="columns"/> 
		from 
			collector c LEFT JOIN orderform o 
			ON c.id=o.cid
        where 
			c.realName=#{realName} 
		order BY c.id 
    </select>
    

    

    
    <update id="updatePhoneNum">
       
        update
          collector
        set
          phoneNumber = #{phoneNumber}
        where
          id = #{id}
      
    </update>
    
    <update id="updatePassword">
       
        update
          collector
        set
          password = #{password}
        where
          id = #{id}
      
    </update>
    
    <update id="updateCreditValue">
       
        update
          collector
        set
          creditValue = #{creditValue}
        where
          id = #{id}
      
    </update>

    
    <update id="addVolume">
       
        update
          collector
        set
          volume = volume+1
        where
          id = #{id}
      
    </update>

    
    <update id="updatePersonData">
       
        update
          collector
        set
           phoneNumber = #{phoneNumber},
           password = #{password},
           realName=#{realName},
           sex=#{sex},
           avater=#{avater}
        where
          id = #{id}
       
    </update>

    <update id="updateState">

        update
        collector
        set
        state = #{state}
        where
        id = #{id}

    </update>

    <delete id="deleteCollector">
        delete
        from
        collector
        where
        id=#{id}

    </delete>

</mapper>