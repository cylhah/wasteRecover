<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.cbb.wasteRecovery.dao.OrderformDao">
<resultMap type="org.cbb.wasteRecovery.bean.Orderform" id="order">
  <id property="id" column="id"/>
  <result property="uid" column="uid"/>
  <result property="cid" column="cid"/>
  <result property="eid" column="eid"/>
  <result property="aid" column="aid"/>
  <result property="staid" column="staid"/>
  <result property="state" column="state"/>
  <result property="weight" column="weight"/>
  <result property="createTime" column="createTime"/>
  <result property="appointSTime" column="appointSTime"/>
  <result property="appointETime" column="appointETime"/>
  <result property="price" column="price"/>
  <collection property="user" resultMap="org.cbb.wasteRecovery.dao.UserDao.User"/>
  <collection property="collector" resultMap="org.cbb.wasteRecovery.dao.CollectorDao.Collect"/>
  <collection property="employee" resultMap="org.cbb.wasteRecovery.dao.EmployeeDao.Employ"/>
  <collection property="station" resultMap="org.cbb.wasteRecovery.dao.StationDao.tion"/>
  <collection property="scraptypeList" resultMap="org.cbb.wasteRecovery.dao.ScraptypeDao.type"/>
  <collection property="address" resultMap="org.cbb.wasteRecovery.dao.UserAddressDao.Address"/>
</resultMap>
    <insert id="insertOrderform">

    insert  into orderform(state,weight,createTime,appointSTime,appointETime,price,aid,uid,cid,eid,staid)
    values (#{state},#{weight},#{createTime},#{appointSTime},#{appointETime},#{price},#{aid},#{uid},#{cid},#{eid},#{staid})
    </insert>


    <sql id="columns">o.id,o.uid,o.cid,o.eid,o.aid,o.state,o.weight,o.createTime,o.appointSTime,o.appointETime,o.price,o.staid,e.id,e.staid,e.adminid,e.username,e.password,a.username,a.password,u.id,u.name,u.sex,u.password,u.phoneNumber,u.email,u.bankAccount,u.avater,d.id,d.uid,d.address,d.fullADD,d.geohash,c.name,c.sex, c.avater,c.email,c.phoneNumber,c.photo,c.creditValue,c.bankAccount,c.idCardNum,c.state,c.id,s.id,s.name,s.money,s.address,s.fullAdd,s.geohash,t.id,t.typeName,t.avergePriceFU,t.avergePriceFC</sql>

     <select id="selectById" resultMap="order" parameterType="long">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.id=#{id}
       
        
    </select>
    
    <select id="selectByCId" resultMap="order" parameterType="int">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.cid=#{cid}
       
        
    </select>
    
    <select id="selectByUId" resultMap="order" parameterType="int">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.uid=#{uid}
       
        
    </select>
    
    <select id="selectByEId" resultMap="order" parameterType="int">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.eid=#{eid}
       
        
    </select>
    
    <select id="selectByStaId" resultMap="order" parameterType="int">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.staid=#{staid}
       
        
    </select>
    
    
    <select id="selectByState" resultMap="order" parameterType="int">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.state=#{state}
       
        
    </select>
    
    <select id="selectByPosAndTime" resultMap="order" parameterType="Map">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
           o.state=#{state}
        and o.appointSTime>=#{appointSTime}
       and o.appointETime<![CDATA[ <= ]]>#{appointETime}
       and o.geoHash like '%'#{geoHash}'%'
        
    </select>
    
     <select id="selectByTime" resultMap="order" parameterType="org.cbb.wasteRecovery.bean.Orderform">
        select <include refid="columns"/>
        from orderform o
        INNER JOIN administrator a,user u,collector c,employee e,station s,scraptype t,useraddress d
        where
          o.appointSTime=#{appointSTime}
       and o.appointETime=#{appointETime}
       
        
    </select>
    

    
     <update id="updateWeight">
       
        update
          orderform
        set
          weight = #{weight}
        where
          id = #{id}
      
    </update>
    
    <update id="updateState">
       
        update
          orderform
        set
          state = #{state}
        where
          id = #{id}
      
    </update>
    
    <update id="updateData">
       
        update
          orderform
        set
          uid= #{uid},
          cid = #{cid},
          eid = #{eid},
          aid= #{aid},
          staid= #{staid},
          price = #{price},
          state = #{state},
          weight = #{weight}
        where
          id = #{id}
      
    </update>
    
    <delete id="deleteOrderform">
       delete
         from
         orderform
       where
           id=#{id}
    
    </delete>
</mapper>